{"version":3,"file":"/home/phat/SourceCode/portal-frontend/tools/tasks/seed/build.js.dev.ts","sources":["/home/phat/SourceCode/portal-frontend/tools/tasks/seed/build.js.dev.ts"],"names":[],"mappings":";AAAA,IAAY,IAAI,WAAM,MAAM,CAAC,CAAA;AAC7B,IAAY,eAAe,WAAM,mBAAmB,CAAC,CAAA;AACrD,IAAY,KAAK,WAAM,cAAc,CAAC,CAAA;AACtC,IAAY,IAAI,WAAM,WAAW,CAAC,CAAA;AAClC,qBAAqB,MAAM,CAAC,CAAA;AAE5B,uBAAqE,cAAc,CAAC,CAAA;AACpF,sBAA8C,aAAa,CAAC,CAAA;AAE5D,IAAM,OAAO,GAAQ,eAAe,EAAE,CAAC;AAEvC,IAAI,iBAAiB,GAAG,+BAAsB,CAAC;AAM/C,iBAAS;IACP,IAAI,SAAc,CAAC;IACnB,IAAI,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC;QACrB,oBAAoB;QACpB,kBAAS,GAAG,2BAA2B;KACxC,CAAC,CAAC;IACH,IAAI,GAAG,GAAG;QACR,WAAI,CAAC,gBAAO,EAAE,SAAS,CAAC;QACxB,GAAG,GAAG,WAAI,CAAC,gBAAO,EAAE,cAAc,CAAC;QACnC,GAAG,GAAG,WAAI,CAAC,gBAAO,EAAE,kBAAkB,CAAC;KACxC,CAAC;IAEF,IAAI,YAAY,GAAG,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;IACjC,IAAI,MAAW,CAAC;IAChB,IAAI,aAAa,GAAG,IAAI,CAAC;IAGzB,EAAE,CAAC,CAAC,iBAAiB,GAAG,+BAAsB,CAAC,CAAC,CAAC;QAC/C,aAAa,GAAG,KAAK,CAAC;QACtB,SAAS,GAAG,qBAAa,CAAC,EAAC,eAAe,EAAE,IAAI,EAAC,CAAC,CAAC;QACnD,YAAY,GAAG,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC;QACnD,IAAI,CAAC,GAAG,CAAC,yCAAyC,CAAC,CAAC;IACtD,CAAC;IAAC,IAAI,CAAC,CAAC;QACN,SAAS,GAAG,qBAAa,EAAE,CAAC;QAC5B,YAAY,GAAG,KAAK,CAAC,OAAO,EAAE,YAAY,CAAC,CAAC;IAC9C,CAAC;IAED,MAAM,GAAG,YAAY;SAClB,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;SACvB,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC;SAC/B,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;SACnC,EAAE,CAAC,OAAO,EAAE;QACX,iBAAiB,GAAG,+BAAsB,CAAC;IAC7C,CAAC,CAAC,CAAC;IAEL,EAAE,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC;QAClB,iBAAiB,GAAG,CAAC,CAAC;IACxB,CAAC;IAAC,IAAI,CAAC,CAAC;QACN,iBAAiB,EAAE,CAAC;IACtB,CAAC;IAED,MAAM,CAAC,MAAM,CAAC,EAAE;SACb,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC;SAChC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,sBAAc,EAAE,CAAC,CAAC;SACxC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,iBAAQ,CAAC,CAAC,CAAC;AAC/B,CAAC,CAAC","sourcesContent":["import * as gulp from 'gulp';\nimport * as gulpLoadPlugins from 'gulp-load-plugins';\nimport * as merge from 'merge-stream';\nimport * as util from 'gulp-util';\nimport { join } from 'path';\n\nimport { APP_DEST, APP_SRC, TOOLS_DIR, TYPED_COMPILE_INTERVAL } from '../../config';\nimport { makeTsProject, templateLocals } from '../../utils';\n\nconst plugins = <any>gulpLoadPlugins();\n\nlet typedBuildCounter = TYPED_COMPILE_INTERVAL; // Always start with the typed build.\n\n/**\n * Executes the build process, transpiling the TypeScript files (except the spec and e2e-spec files) for the development\n * environment.\n */\nexport = () => {\n  let tsProject: any;\n  let typings = gulp.src([\n    'typings/index.d.ts',\n    TOOLS_DIR + '/manual_typings/**/*.d.ts'\n  ]);\n  let src = [\n    join(APP_SRC, '**/*.ts'),\n    '!' + join(APP_SRC, '**/*.spec.ts'),\n    '!' + join(APP_SRC, '**/*.e2e-spec.ts')\n  ];\n\n  let projectFiles = gulp.src(src);\n  let result: any;\n  let isFullCompile = true;\n\n  // Only do a typed build every X builds, otherwise do a typeless build to speed things up\n  if (typedBuildCounter < TYPED_COMPILE_INTERVAL) {\n    isFullCompile = false;\n    tsProject = makeTsProject({isolatedModules: true});\n    projectFiles = projectFiles.pipe(plugins.cached());\n    util.log('Performing typeless TypeScript compile.');\n  } else {\n    tsProject = makeTsProject();\n    projectFiles = merge(typings, projectFiles);\n  }\n\n  result = projectFiles\n    .pipe(plugins.plumber())\n    .pipe(plugins.sourcemaps.init())\n    .pipe(plugins.typescript(tsProject))\n    .on('error', () => {\n      typedBuildCounter = TYPED_COMPILE_INTERVAL;\n    });\n\n  if (isFullCompile) {\n    typedBuildCounter = 0;\n  } else {\n    typedBuildCounter++;\n  }\n\n  return result.js\n    .pipe(plugins.sourcemaps.write())\n    .pipe(plugins.template(templateLocals()))\n    .pipe(gulp.dest(APP_DEST));\n};\n"]}