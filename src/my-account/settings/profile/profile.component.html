<div class="box-panel">
  <h3 class="box-panel-title">Personal information</h3>
  <p class="text-fade">Your personal information on this page is private and used for WTHApps administrative and payment
    purposes.</p>
  <form [formGroup]="form" (ngSubmit)="onSubmit(form.value)" novalidate>
    <div class="row">
      <div class="col-xs-6 col-sm-4">
        <div class="form-group" [ngClass]="{'has-error': (!first_name.valid && first_name.touched),
        'has-success': (first_name.valid && first_name.touched)}">
          <label for="first_name">First Name</label>
          <input [formControl]="first_name" type="text" class="form-control" id="first_name"
                 placeholder="First Name">
          <div *ngIf="!first_name.valid && first_name.touched">
              <span *ngIf="!first_name.valid && first_name.errors.required" class="help-block">
                First name is required
              </span>
            <span *ngIf="!first_name.valid && first_name.errors.blanked" class="help-block">
                First name is blanked
              </span>
          </div>
        </div>
      </div>
      <div class="col-xs-6 col-sm-4">
        <div class="form-group" [ngClass]="{'has-error': (!last_name.valid && last_name.touched),
        'has-success': (last_name.valid && last_name.touched)}">
          <label for="last_name">Last Name</label>
          <input [formControl]="last_name" type="text" class="form-control" id="last_name" placeholder="Last Name">
          <div *ngIf="!last_name.valid && last_name.touched">
              <span *ngIf="!last_name.valid && last_name.errors.required" class="help-block">
                Last name is required
              </span>
            <span *ngIf="!last_name.valid && last_name.errors.blanked" class="help-block">
                Last name is blanked
              </span>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-xs-12 col-sm-8">
        <div class="form-group" [ngClass]="{'has-error': (!email.valid && email.touched),
        'has-success': (email.valid && email.touched)}">
          <label class="sr-only" for="email">Email address</label>
          <input [formControl]="email" type="email" class="form-control" id="email" placeholder="Email">

          <ng-container *ngIf="confirmedEmail; else sent_verify">
            <div style="position: relative; top: -30px; right: 10px; float: right; color: green; font-size: 20px"><i
              class="fa fa-check-circle"></i></div>
          </ng-container>

          <ng-template #sent_verify>
            <button type=button (click)="sendVerifyEmail()" class="verify"
                    style="height: 34px; position: relative; top: -34px; float: right; border-radius: 0px 4px 4px 0px; background: #eeeeee;">
              Verify Email
            </button>
          </ng-template>
          <div *ngIf="!email.valid && email.touched">
            <span *ngIf="!email.valid && email.errors.required" class="help-block">An email is required</span>
            <span *ngIf="!email.errors.required && email.errors.emailFormat" class="help-block">
              Email is not valid. eg. example@wthapps.com
            </span>
          </div>
        </div>
      </div>
    </div>
    <div class="form-group">
      <div class="row">
        <div class="col-xs-8">
          <label for="phone_number">Phone Number</label>
          <div class="row">
            <div class="col-xs-5">
              <w-countries [countryCode]="userService.getSyncProfile().nationality.toLowerCase()"
                           (completeChange)="onCompleteChange($event)"></w-countries>
              <input type="hidden" formControlName="phone_prefix">
            </div>
            <div class="col-xs-7">
              <input type="text" class="form-control" id="phone_number" name="phone_number"
                     [formControl]="phone_number">
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="form-group">
      <div class="row">
        <div class="col-xs-8">
          <label>Birthday</label>
          <div class="row">
            <div class="col-xs-12">
              <p-calendar formControlName="birthday" [monthNavigator]="true" [yearNavigator]="true"
                          yearRange="{{ yearRange }}"></p-calendar>
            </div>
          </div>
        </div>
      </div>
    </div>
    <button [disabled]="!form.valid || (form.pristine && !phoneChanged)" type="submit"
            class="btn btn-outline-primary btn-min mb20">Update
    </button>
  </form>
</div>

