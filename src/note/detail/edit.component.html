<form [formGroup]="form" novalidate class="note-editor-wrap">
  <div class="note-editor-header">
    <div class="note-editor-header-content">
      <div class="note-editor-header-action note-editor-header-action-right component-listbox-action">
        <z-note-shared-actions-bar class="action" [data]="note" [subPage]="subPage"
                                   [selectedObjects]="[note]"></z-note-shared-actions-bar>
        <button type="button" (click)="onSubmit(form.value)" [disabled]="!form.valid"
                class="btn btn-outline-primary btn-min">Done
        </button>
      </div>

      <div class="note-editor-header-input">
        <input *ngIf="note.permission !== 'view'" tabindex="1" autofocus (keypress)="onToEditor($event)" [formControl]="title" type="text"
               class="form-control fz18" id="note_form_title"
               placeholder="Title">
        <h4 *ngIf="note.permission == 'view'">{{note.title}}</h4>
      </div>
    </div>
  </div>
  <div class="note-editor-nav">
    <nav class="nav-tabs-wrap nav-tabs-wrap-sm">
      <ul class="nav nav-tabs list-unstyled clearfix">
        <li [ngClass]="{'active': currentTab == 'note'}">
          <a (click)="currentTab = 'note'" href="javascript:;"><i class="fa fa-sticky-note"></i> Note</a>
        </li>
        <li [ngClass]="{'active': currentTab == 'attachment'}">
          <a (click)="currentTab = 'attachment'" href="javascript:;"><i class="fa fa-paperclip"></i> Attachment
            ({{ note?.attachments?.length || 0 }})</a>
        </li>
        <li class="pull-right">
          <a (click)="hasShowComment = !hasShowComment" href="javascript:;">
            <i class="fa fa-comment"></i> Comment
            <i *ngIf="!hasShowComment" class="fa fa-caret-right"></i>
            <i *ngIf="hasShowComment" class="fa fa-caret-left"></i>
          </a>
        </li>
      </ul>
    </nav>
  </div>
  <div class="note-editor-content" [ngClass]="{'show-aside': hasShowComment}">
    <div class="note-editor-toolbar" *ngIf="note.permission !== 'view'">
      <div class="container">
        <div [ngClass]="{'hidden': currentTab !== 'note'}" id="quill-toolbar">
          <div class="ql-format-group">
            <div class="ql-formats">
              <button pTooltip="Undo" tooltipPosition="bottom" type="button" (click)="undo()">
                <i class="fa fa-reply"></i>
              </button>
              <button pTooltip="Redo" tooltipPosition="bottom" type="button" (click)="redo()">
                <i class="fa fa-share"></i>
              </button>
              <button pTooltip="Paint format" tooltipPosition="bottom" type="button" (click)="copyFormat()">
                <i class="fa fa-paint-brush"></i>
              </button>
            </div>
            <div class="ql-formats no-right-margin">
              <select class="ql-header left-border-radius" pTooltip="Styles">
                <option value="0">Normal</option>
                <option value="1" selected="">Heading 1</option>
                <option value="2">Heading 2</option>
                <option value="3">Heading 3</option>
                <option value="4">Heading 4</option>
                <option value="5">Heading 5</option>
                <option value="6">Heading 6</option>
              </select>

              <select class="ql-font no-border-radius" title="Font">
                <option value="gotham" selected="">Gotham</option>
                <option value="georgia">Georgia</option>
                <option value="helvetica">Helvetica</option>
                <option value="courier-new">Courier New</option>
                <option value="times-new-roman">Times New Roman</option>
                <option value="trebuchet">Trebuchet</option>
                <option value="verdana">Verdana</option>
              </select>

              <select class="ql-size ql-size-sm no-border-radius" title="Font size">
                <option value="8px">8</option>
                <option value="10px">10</option>
                <option value="12px">12</option>
                <option selected value="14px">14</option>
                <option value="18px">18</option>
                <option value="24px">24</option>
                <option value="36px">36</option>
              </select>

              <select class="ql-color no-border-radius" title="Text color">
                <option value="#ffffff"></option>
                <option value="#facccc"></option>
                <option value="#ffebcc"></option>
                <option value="#ffffcc"></option>
                <option value="#cce8cc"></option>
                <option value="#cce0f5"></option>
                <option value="#ebd6ff"></option>
                <option value="#bbbbbb"></option>
                <option value="#f06666"></option>
                <option value="#ffc266"></option>
                <option value="#ffff66"></option>
                <option value="#66b966"></option>
                <option value="#66a3e0"></option>
                <option value="#c285ff"></option>
                <option value="#888888"></option>
                <option value="#a10000"></option>
                <option value="#b26b00"></option>
                <option value="#b2b200"></option>
                <option value="#006100"></option>
                <option value="#0047b2"></option>
                <option value="#6b24b2"></option>
                <option value="#444444"></option>
                <option value="#5c0000"></option>
                <option value="#663d00"></option>
                <option value="#666600"></option>
                <option value="#003700"></option>
                <option value="#002966"></option>
                <option value="#3d1466"></option>
                <option value="#000000"></option>
                <option value="#e60000"></option>
                <option value="#ff9900"></option>
                <option value="#ffff00"></option>
                <option value="#008a00"></option>
                <option value="#0066cc"></option>
                <option value="#9933ff"></option>
              </select>

              <!-- Add background -->
              <select class="ql-background right-border-radius" title="Background">
                <option value="#ffffff"></option>
                <option value="#facccc"></option>
                <option value="#ffebcc"></option>
                <option value="#ffffcc"></option>
                <option value="#cce8cc"></option>
                <option value="#cce0f5"></option>
                <option value="#ebd6ff"></option>
                <option value="#bbbbbb"></option>
                <option value="#f06666"></option>
                <option value="#ffc266"></option>
                <option value="#ffff66"></option>
                <option value="#66b966"></option>
                <option value="#66a3e0"></option>
                <option value="#c285ff"></option>
                <option value="#888888"></option>
                <option value="#a10000"></option>
                <option value="#b26b00"></option>
                <option value="#b2b200"></option>
                <option value="#006100"></option>
                <option value="#0047b2"></option>
                <option value="#6b24b2"></option>
                <option value="#444444"></option>
                <option value="#5c0000"></option>
                <option value="#663d00"></option>
                <option value="#666600"></option>
                <option value="#003700"></option>
                <option value="#002966"></option>
                <option value="#3d1466"></option>
                <option value="#000000"></option>
                <option value="#e60000"></option>
                <option value="#ff9900"></option>
                <option value="#ffff00"></option>
                <option value="#008a00"></option>
                <option value="#0066cc"></option>
                <option value="#9933ff"></option>
              </select>
            </div>

            <div class="ql-formats">
              <button pTooltip="Bold ({{buttonControl}} + B)" tooltipPosition="bottom" class="ql-bold"
                      aria-label="Bold"></button>
              <button pTooltip="Italic ({{buttonControl}} + I)" tooltipPosition="bottom" class="ql-italic"
                      aria-label="Italic"></button>
              <button pTooltip="Underline ({{buttonControl}} + U)" tooltipPosition="bottom" class="ql-underline"
                      aria-label="Underline"></button>
              <button pTooltip="Strikethrough" tooltipPosition="bottom" class="ql-strike"
                      aria-label="Strikethrough"></button>
            </div>
            <div tooltipPosition="bottom" class="ql-formats">
              <button pTooltip="Left align" tooltipPosition="bottom" class="ql-align"></button>
              <button pTooltip="Center align" tooltipPosition="bottom" class="ql-align" value="center"></button>
              <button pTooltip="Right align" tooltipPosition="bottom" class="ql-align" value="right"></button>
              <button pTooltip="Justify" tooltipPosition="bottom" class="ql-align" value="justify"></button>

              <!--<select class="ql-align">-->
              <!--<option selected></option>-->
              <!--<option value="center"></option>-->
              <!--<option value="right"></option>-->
              <!--<option value="justify"></option>-->
              <!--</select>-->
            </div>
            <div class="ql-formats">
              <button pTooltip="Checkbox" tooltipPosition="bottom" class="ql-list" value="check"></button>
              <button pTooltip="Ordered List" tooltipPosition="bottom" class="ql-list" value="ordered"></button>
              <button pTooltip="Unordered List" tooltipPosition="bottom" class="ql-list" value="bullet"></button>

              <button pTooltip="Decrease indent" tooltipPosition="bottom" class="ql-indent" value="-1"></button>
              <button pTooltip="Increase indent" tooltipPosition="bottom" class="ql-indent" value="+1"></button>
            </div>

            <div pTooltip="Divider line" tooltipPosition="bottom" class="ql-formats">
              <button type="button" (click)="divider()">
                <i>&mdash;</i>
              </button>
            </div>

            <div class="ql-formats">
              <button pTooltip="Insert Link ({{buttonControl}} + K)" tooltipPosition="bottom"
                      class="ql-link"></button>
              <button pTooltip="Insert Image" tooltipPosition="bottom" class="ql-image"></button>
              <button pTooltip="Code View" tooltipPosition="bottom" class="ql-code-block"></button>
              <!--<button class="ql-video"></button>-->
              <!--<button class="ql-formula"></button>-->
            </div>
            <!--<div class="ql-formats">
              <button class="ql-clean"></button>
            </div>-->
            <div class="ql-formats">
              <button pTooltip="Clear formatting" tooltipPosition="bottom" class="ql-clean"></button>

              <!-- Add subscript and superscript buttons -->
              <!--<button pTooltip="Subscript" tooltipPosition="bottom" class="ql-script" value="sub"></button>-->
              <!--<button pTooltip="Superscript" tooltipPosition="bottom" class="ql-script" value="super"></button>-->
            </div>

          </div>
        </div>
        <div [ngClass]="{'hidden': currentTab !== 'attachment'}" class="quill-toolbar-attachment">
          <div class="btn-group">
            <button type="button" class="btn btn-outline-default" (click)="selectPhotos()" [disabled]="note.permission == 'view'">
              <i class="fa fa-plus"></i> Photo
            </button>
            <button class="btn btn-outline-default can-click btn-style-1 fileinput-button"
                  pTooltip="{{ tooltip.addAttachments }}" tooltipPosition="top" [disabled]="note.permission == 'view'">
                  <i class="fa fa-paperclip"></i> Attachment
                  <input id="files" #fileBrowse type="file" multiple="multiple" (click)="fileBrowse.value='';"
                         (change)="selectFiles($event)"/>
            </button>
          </div>

          <div class="btn-group ml10">
            <button class="btn btn-outline-default" [disabled]="note.attachments.length === 0"
                    (click)="downloadAttachments()">
              <i class="fa fa-download"></i> Download all
            </button>
          </div>

        </div>
      </div>
    </div>
    <div class="note-editor-aside">

    </div>
    <div class="note-editor-body" id="scrolling-container">
      <div class="container" id="quill-container-wrapper">
        <!--<div id="quill-content-body" style="position: relative; padding: 0">-->
          <div [ngClass]="{'hidden': currentTab !== 'note'}" id="quill-editor"></div>
          <div [ngClass]="{'hidden': currentTab !== 'attachment'}" class="attachment-list-wrap">

            <table class="table table-middle wth-table table-hover"
                   *ngIf="note.attachments && note.attachments.length > 0">
              <thead>
              <tr>
                <th class="can-click" (click)="onSort('name')">
                  Name <i *ngIf="hasSortBy" class="fa"
                          [ngClass]="{'fa-arrow-up': !orderDesc, 'fa-arrow-down': orderDesc }"></i>
                </th>
                <th>File size</th>
                <th>Date Modified</th>
                <th>&nbsp;</th>
              </tr>
              </thead>
              <tbody>
              <tr *ngFor="let att of note.attachments">
                <td [ngClass]="{'can-click': att.object_type == 'photo'}" (click)="fileAttachmentClick(att)">
                  <i *ngIf="att.thumbnail_url && att.object_type == 'photo'" class="fa fa-picture-o"></i>
                  <i *ngIf="att.thumbnail_url && att.object_type !== 'photo'" class="fa fa-file"></i>
                  <i *ngIf="!att.thumbnail_url" class="fa fa-spinner fa-pulse fa-fw"></i>
                  {{ att.name }}
                </td>
                <td>{{ att.size | bytes:3 }}</td>
                <td>{{ (att.updated_at || att.created_at) | date: 'MMM dd yyyy' }}</td>
                <td class="text-right">
                  <button class="btn btn-sm btn-default" type="button" (click)="download(att)">
                    <i class="fa fa-download"></i>
                  </button>
                  <button (click)="cancelUpload(att)" class="btn btn-sm btn-default" type="button" [disabled]="note.permission == 'view'">
                    <i class="fa fa-trash-o"></i>
                  </button>
                </td>
              </tr>
              </tbody>
            </table>
          </div>
        <!--</div>-->
      </div>
    </div>

    <div id="counter"></div>

  </div>
</form>
