<bs-modal #modal cssClass="modal-media-selection" [keyboard]="false" [animation]="false" [backdrop]="'static'" (onDismiss)="dismiss($event)"
  style="z-index: 1111;">
  <bs-modal-header [showDismiss]="true">
    <div *ngIf="searchShow" class="modal-media-search">
      <div class="modal-media-search-in">
        <textbox-search [placeholder]="'Search something'" [showSearchClearText]="true" [search]="searchText" (onEnterEvent)="onSearchEnter($event)"
          (onEscapeEvent)="onSearchEscape($event)">
        </textbox-search>
      </div>

    </div>
    <button (click)="searchShow = true" class="btn btn-search btn-default pull-right" type="button">
      <i class="fa fa-search"></i>
    </button>

    <w-nav-tab [tabs]="tabsFilter" [setTabActive]="currentTab" (currentTab)="tabAction($event)"></w-nav-tab>

    <w-object-toolbar-selected [selectedObjects]="selectedMedias$ | async" *ngIf="currentTab == 'photos' ||
      currentTab == 'albums_detail' ||
      currentTab == 'favourites' ||
      currentTab == 'favourites_detail' ||
      currentTab == 'shared_with_me' ||
      currentTab == 'videos' ||
      currentTab == 'playlists' ||
      currentTab == 'shared_with_me_detail'">
      <button (click)="onInsert()" class="btn btn-outline-default" type="button">Insert</button>
    </w-object-toolbar-selected>
  </bs-modal-header>
  <bs-modal-body>
    <div *ngIf="currentTab !== 'upload'" class="media-selection-toolbar">
      <div *ngIf="currentTab == 'albums_detail' ||
            currentTab == 'favourites_detail' ||
            currentTab == 'shared_with_me_detail'" class="media-selection-toolbar-left pull-left">
        <ul class="list-unstyled">
          <li class="divider">
            <button (click)="onTabBack()" class="btn btn-default" type="button">
              <i class="fa fa-arrow-left"></i>
            </button>
          </li>
          <li>
            <span *ngIf="mediaParent" class="btn btn-text">{{ mediaParent?.name }}</span>
          </li>
        </ul>
      </div>
      <div *ngIf="currentTab == 'search'" class="media-selection-toolbar-left pull-left">
        <ul class="list-unstyled">
          <li>
            <span class="btn btn-text">Search result</span>
          </li>
        </ul>
      </div>
      <w-object-toolbar-view class="pull-right"></w-object-toolbar-view>
    </div>

    <ng-container *ngIf="currentTab === 'upload'">
      <div class="media-selection-content gray-light">
        <div class="media-selection-upload-wrap">
          <dropzone class="dropzone-container" [config]="dropzoneConfig" [disabled]="dropzoneDisabled" [message]="'<h3><i class=\'fa fa-picture-o\'></i><span>Drag your photos here</span></h3>or<div><span class=\'btn btn-outline-primary\'><i class=\'fa fa-cloud-upload\'></i> Upload Photo</span></div>'"
            (error)="onUploadError($event)" (thumbnail)="onUploadThumbnail($event)" (success)="onUploadSuccess($event)">
          </dropzone>
        </div>

      </div>
    </ng-container>
    <ng-container *ngIf="currentTab !== 'upload'">
      <ng-container *ngIf="medias$ | async as mediasList; else templateloading">
        <ng-container *ngIf="mediasList?.length; else templateNodata">
          <w-object-list class="media-selection-content gray-light" [data]="mediasList" [sortInline]="false" (completeSort)="onCompleteSort($event)"
            (completeLoadMore)="onCompleteLoadMore($event)" (completeDoubleClick)="onCompleteDoubleClick($event)">
            <ng-template #columnBox let-item>

              <!-- ------------ Album view ------------- -->
              <ng-container *ngIf="item.object_type == 'album' || item.model == 'Media::Playlist'">
                <div class="wobject-box-img">
                  <img [src]="item.thumbnail_url" alt="">
                  <div class="wmedia-box-info">{{ item.child_count }} photo
                    <span *ngIf="item.child_count>1">s</span>
                  </div>
                </div>
                <div class="wobject-box-name">
                  <span>{{ item.name }}</span>
                  <div class="wobject-box-action">
                    <i class="fa fa-star" [ngClass]="{'fa-star-o': !item.favorite}"></i>
                  </div>
                </div>
              </ng-container>


              <!-- ------------ Photo, Video view ------------- -->
              <ng-container *ngIf="item.object_type == 'photo' || item.model == 'Media::Video'">
                <div class="wobject-box-img">
                  <img [src]="item.thumbnail_url" alt="">
                </div>
                <div class="wobject-box-name">

                  <span>{{ item.name }}.{{ item.extension }}</span>
                  <div class="wobject-box-action">
                    <i class="fa fa-star" [ngClass]="{'fa-star-o': !item.favorite}"></i>
                  </div>
                </div>
              </ng-container>
            </ng-template>
            <ng-template #columnFileSize let-item>
              <span *ngIf="item.object_type == 'album'">{{ item.photo_number }} file
                <span *ngIf="item.photo_number>1">s</span>
              </span>
              <span *ngIf="item.object_type == 'photo'">{{ item.size | bytes:0 }}</span>
            </ng-template>
          </w-object-list>
        </ng-container>
        <ng-template #templateNodata>
          <div class="media-selection-content gray-light">
            <box-no-data [icon]="'fa fa-picture-o'" [title]="'There is no photo!'" [subTitle]="'There is no photo. Try to upload a file.'">
            </box-no-data>
          </div>
        </ng-template>
      </ng-container>
      <ng-template #templateloading>
        <div class="media-selection-content gray-light">
          <box-loading></box-loading>
        </div>
      </ng-template>
    </ng-container>


  </bs-modal-body>
</bs-modal>
